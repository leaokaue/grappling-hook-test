[gd_scene load_steps=20 format=3 uid="uid://j8g4eswsbsm4"]

[ext_resource type="Script" uid="uid://by288yp8t6qs" path="res://scenes/glitched_coin.gd" id="1_8jtn3"]
[ext_resource type="Texture2D" uid="uid://b2xs1j1q1scfq" path="res://sprites/nolan.jpg" id="2_4axvi"]
[ext_resource type="Shader" uid="uid://cnmfovagnfevp" path="res://shaders/shine.gdshader" id="3_vgns6"]
[ext_resource type="Shader" uid="uid://bs1d410se80e6" path="res://glitch.gdshader" id="4_misvd"]
[ext_resource type="Texture2D" uid="uid://dkjp35tckxbnh" path="res://sprites/PeculiarCoin.png" id="5_dt7p8"]
[ext_resource type="AudioStream" uid="uid://btfo1jl4l68vm" path="res://sounds/glitched_bling.mp3" id="6_8jtn3"]
[ext_resource type="Texture2D" uid="uid://b2hpi4gi8412a" path="res://sprites/ball.png" id="7_4r3eo"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_tiefo"]
shader = ExtResource("3_vgns6")
shader_parameter/Line_Smoothness = 0.045
shader_parameter/Line_Width = 0.09
shader_parameter/Brightness = 3.0
shader_parameter/Rotation_deg = 30.0
shader_parameter/Distortion = 1.8
shader_parameter/Speed = 0.7
shader_parameter/Position = 0.0
shader_parameter/Position_Min = 0.25
shader_parameter/Position_Max = 0.5
shader_parameter/Alpha = 1.0

[sub_resource type="Gradient" id="Gradient_d7h6m"]
offsets = PackedFloat32Array(1)
colors = PackedColorArray(1, 1, 1, 1)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_rialx"]
gradient = SubResource("Gradient_d7h6m")

[sub_resource type="Shader" id="Shader_8jtn3"]
code = "/*
	Glitch Effect Shader by Yui Kinomoto @arlez80

	MIT License
*/

shader_type canvas_item;

// 振動の強さ
uniform float shake_power = 0.03;
// 振動率
uniform float shake_rate : hint_range( 0.0, 1.0 ) = 0.2;
// 振動速度
uniform float shake_speed = 5.0;
// 振動ブロックサイズ
uniform float shake_block_size = 30.5;
// 色の分離率
uniform float shake_color_rate : hint_range( 0.0, 1.0 ) = 0.01;

uniform sampler2D SCREEN_TEXTURE : hint_screen_texture, filter_linear_mipmap;

float random( float seed )
{
	return fract( 543.2543 * sin( dot( vec2( seed, seed ), vec2( 3525.46, -54.3415 ) ) ) );
}

void fragment( )
{
	float enable_shift = float(
		random( trunc( TIME * shake_speed ) )
	<	shake_rate
	);

	vec2 fixed_uv = SCREEN_UV;
	fixed_uv.x += (
		random(
			( trunc( SCREEN_UV.y * shake_block_size ) / shake_block_size )
		+	TIME
		) - 0.5
	) * shake_power * enable_shift;

	vec4 pixel_color = textureLod( SCREEN_TEXTURE, fixed_uv, 0.0 );
	pixel_color.r = mix(
		pixel_color.r
	,	textureLod( SCREEN_TEXTURE, fixed_uv + vec2( shake_color_rate, 0.0 ), 0.0 ).r
	,	enable_shift
	);
	pixel_color.b = mix(
		pixel_color.b
	,	textureLod( SCREEN_TEXTURE, fixed_uv + vec2( -shake_color_rate, 0.0 ), 0.0 ).b
	,	enable_shift
	);
	COLOR = pixel_color;
}
"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_smlsx"]
shader = SubResource("Shader_8jtn3")
shader_parameter/shake_power = 0.03
shader_parameter/shake_rate = 0.2
shader_parameter/shake_speed = 4.5
shader_parameter/shake_block_size = 30.5
shader_parameter/shake_color_rate = 0.01

[sub_resource type="ShaderMaterial" id="ShaderMaterial_gcwh6"]
shader = ExtResource("4_misvd")
shader_parameter/shake_power = 0.035
shader_parameter/shake_rate = 1.0
shader_parameter/shake_speed = 5.0
shader_parameter/shake_block_size = 26.96
shader_parameter/shake_color_rate = 0.0050000002375

[sub_resource type="RectangleShape2D" id="RectangleShape2D_sr8hx"]
size = Vector2(114, 192)

[sub_resource type="Curve" id="Curve_qexnq"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(0.231183, 1), 0.0, 0.0, 0, 0, Vector2(0.801075, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 4

[sub_resource type="CurveTexture" id="CurveTexture_prwm1"]
curve = SubResource("Curve_qexnq")

[sub_resource type="Curve" id="Curve_q3vyb"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(0.629032, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 3

[sub_resource type="CurveTexture" id="CurveTexture_qr2wd"]
curve = SubResource("Curve_q3vyb")

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_yhcpg"]
particle_flag_disable_z = true
emission_shape = 1
emission_sphere_radius = 35.1
spread = 180.0
initial_velocity_min = 148.65
initial_velocity_max = 283.79
gravity = Vector3(0, 98, 0)
scale_min = 0.1
scale_max = 0.1
scale_curve = SubResource("CurveTexture_qr2wd")
color = Color(1, 0.916667, 0, 1)
alpha_curve = SubResource("CurveTexture_prwm1")

[node name="GlitchedCoin" type="Node2D"]
process_mode = 3
z_index = -1
scale = Vector2(0.355873, 0.358999)
script = ExtResource("1_8jtn3")

[node name="Polygon2D" type="Node2D" parent="."]

[node name="po" type="Polygon2D" parent="Polygon2D"]
clip_children = 1
polygon = PackedVector2Array(-6, 76, 17, 73, 29, 64, 31, 54, 35, 42, 38, 28, 41, 13, 40, -5, 39, -22, 39, -34, 35, -51, 26, -68, 9, -73, -6, -74, -22, -71, -31, -61, -36, -52, -41, -34, -42, -14, -43, 16, -41, 36, -37, 53, -31, 64, -18, 73)

[node name="Sprite2D" type="Sprite2D" parent="Polygon2D/po"]
modulate = Color(1, 0.766667, 0, 1)
position = Vector2(-1, -1)
scale = Vector2(0.125045, 0.125045)
texture = ExtResource("2_4axvi")

[node name="TextureRect" type="TextureRect" parent="Polygon2D/po"]
material = SubResource("ShaderMaterial_tiefo")
offset_left = -44.0
offset_top = 77.0
offset_right = 110.0
offset_bottom = 162.0
rotation = -1.5708
texture = SubResource("GradientTexture1D_rialx")
expand_mode = 1

[node name="Line2D" type="Line2D" parent="Polygon2D"]
points = PackedVector2Array(2, -73, 19, -69, 25, -67, 32, -57, 36, -43, 38, -24, 39, -6, 43, 14, 40, 26, 36, 38, 35, 49, 29, 60, 26, 67, 19, 72, 6, 74, -9, 75, -22, 73, -29, 68, -34, 59, -36, 52, -40, 43, -41, 36, -44, 27, -44, 17, -44, 9, -44, 1, -44, -9, -44, -16, -44, -24, -42, -36, -39, -48, -38, -54, -34, -61, -28, -68, -24, -71, -18, -74, -11, -75, -3, -75, 4, -72)
default_color = Color(1, 0.75, 0, 1)
antialiased = true

[node name="Sprite2D2" type="Sprite2D" parent="Polygon2D"]
visible = false
material = SubResource("ShaderMaterial_smlsx")
position = Vector2(1.3400642, 0.0003671646)
scale = Vector2(0.34013146, 0.34603414)
texture = ExtResource("5_dt7p8")

[node name="Polygon2D" type="Polygon2D" parent="Polygon2D"]
material = SubResource("ShaderMaterial_gcwh6")
scale = Vector2(1.569468, 1.569468)
polygon = PackedVector2Array(-19.669922, -86.350586, 25.29004, -86.350586, 64.45476, -74.542435, 75.19722, -8.8741, 69.82599, 40.820858, 35.8082, 76.31725, 5.37123, 83.416534, -32.22738, 83.416534, -71.6164, 60.343876, -87.730095, 19.523018, -87.730095, -47.920135, -55.502712, -83.416534)

[node name="Area2D" type="Area2D" parent="."]
visible = false
collision_mask = 2

[node name="CollisionShape2D" type="CollisionShape2D" parent="Area2D"]
shape = SubResource("RectangleShape2D_sr8hx")
debug_color = Color(0, 0.595, 0.7, 0)

[node name="bling" type="AudioStreamPlayer" parent="."]
stream = ExtResource("6_8jtn3")
volume_db = -15.0
pitch_scale = 1.2

[node name="collect" type="GPUParticles2D" parent="."]
emitting = false
amount = 32
texture = ExtResource("7_4r3eo")
lifetime = 0.4
one_shot = true
explosiveness = 0.9
process_material = SubResource("ParticleProcessMaterial_yhcpg")

[node name="Node2D" type="Node2D" parent="."]
